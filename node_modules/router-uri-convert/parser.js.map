{"version":3,"file":"parser.js","sourceRoot":"","sources":["parser.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;AAEH,qEAA+B;AAC/B,aAAa;AACb,yDAAwC;AAExC;;GAEG;AACH,MAAM,QAAQ,GAAG,8CAA8C,CAAC;AAEhE,SAAgB,eAAe,CAAC,GAAW;IAE1C,OAAO,IAAA,kBAAO,EAAC,QAAQ,EAAE,GAAG,CAAC;SAC3B,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE;QAEZ,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACnB,CAAC,CAAC,CACF;AACF,CAAC;AARD,0CAQC;AAED,SAAgB,MAAM,CAAyD,GAAW,EAAE,IAAO;IAElG,IAAI,EAAE,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC;IAE9B,IAAI,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;QAE5B,IAAI,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,EAClB;YACC,aAAa;YACb,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;SACpB;aAED;YACC,aAAa;YACb,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;SACnB;QAED,OAAO,CAAC,CAAC;IACV,CAAC,EAAE;QACF,KAAK,EAAE,EAAgB;QACvB,IAAI,EAAE,EAAgB;KACtB,CAAC,CAAC;IAEH,OAAO;QACN,MAAM,EAAE,GAAG;QACX,GAAG,EAAE,IAAI,uBAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,IAAI,CAAW;QACjD,GAAG,GAAG;KACN,CAAA;AACF,CAAC;AA5BD,wBA4BC;AAED,kBAAe,eAAe,CAAA","sourcesContent":["/**\n * Created by user on 2019/6/10.\n */\n\nimport execall from 'execall2';\n// @ts-ignore\nimport { URI } from 'uri-template-lite';\n\n/**\n * @see uri-template-lite\n */\nconst expandRe = /\\{([#&+.\\/;?]?)((?:[\\w%.]+(\\*|:\\d+)?,?)+)\\}/g;\n\nexport function parseRouterVars(url: string)\n{\n\treturn execall(expandRe, url)\n\t\t.map((row) =>\n\t\t{\n\t\t\treturn row.sub[1];\n\t\t})\n\t;\n}\n\nexport function expand<K extends keyof M = never, M = Record<string, unknown>>(url: string, data: M)\n{\n\tlet ks = parseRouterVars(url);\n\n\tlet ret = ks.reduce((a, k) => {\n\n\t\tif (ks.includes(k))\n\t\t{\n\t\t\t// @ts-ignore\n\t\t\ta.paths[k] = data[k]\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// @ts-ignore\n\t\t\ta.data[k] = data[k]\n\t\t}\n\n\t\treturn a;\n\t}, {\n\t\tpaths: {} as Pick<M, K>,\n\t\tdata: {} as Omit<M, K>,\n\t});\n\n\treturn {\n\t\trouter: url,\n\t\turl: new URI.Template(url).expand(data) as string,\n\t\t...ret,\n\t}\n}\n\nexport default parseRouterVars\n"]}