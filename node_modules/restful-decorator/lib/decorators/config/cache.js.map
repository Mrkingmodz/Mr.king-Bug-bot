{"version":3,"file":"cache.js","sourceRoot":"","sources":["cache.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;AAEH,4BAA0B;AAG1B,mCAAwD;AAGxD,iEAA4G;AAC5G,0EAAgD;AAEnC,QAAA,oBAAoB,GAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC;AAEhE,SAAgB,YAAY,CAAC,MAA6D;IAEzF,OAAO,UAAU,MAAW,EAAE,YAA2B;QAExD,IAAI,MAAM,CAAC,KAAK,EAChB;YACC,IAAI,GAAG,GAAG,IAAA,eAAgB,EAAC,MAAM,CAAC,CAAC;YAEnC,MAAM,EAAE,KAAK,EAAE,GAAG,GAAG,CAAC;YAEtB,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;YAEpB,oBAAoB,CAAC,KAAK,EAAE,MAAM,EAAE,YAAY,CAAC,CAAA;SACjD;QAED,OAAO,IAAA,sBAAc,EAAC,MAAM,CAAC,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;IACrD,CAAC,CAAA;AACF,CAAC;AAjBD,oCAiBC;AAED,SAAgB,oBAAoB,CAAC,MAAW,EAAE,YAA2B;IAE5E,OAAO,IAAA,uCAAe,EAAC,4BAAoB,EAAE,MAAM,EAAE,YAAY,CAAC,CAAA;AACnE,CAAC;AAHD,oDAGC;AAED,SAAgB,oBAAoB,CAAC,KAAkB,EAAE,MAAW,EAAE,YAA2B;IAEhG,OAAO,IAAA,yCAAiB,EAAC,4BAAoB,EAAE,KAAK,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;AAC7E,CAAC;AAHD,oDAGC;AAED,kBAAe,YAAY,CAAC","sourcesContent":["/**\n * Created by user on 2019/6/10.\n */\n\nimport 'reflect-metadata';\nimport { setupCache, IAxiosCacheAdapterOptions, ISetupCache } from 'axios-cache-adapter';\nimport Bluebird from 'bluebird';\nimport RequestConfig, { RequestConfigs } from './index';\nimport { AxiosRequestConfig } from '../../types/axios';\nimport defaultsDeep from 'lodash/defaultsDeep';\nimport { getMemberMetadata, IPropertyKey, setMemberMetadata, getMetadataLazy } from 'reflect-metadata-util';\nimport setupCacheConfig from '../../wrap/cache';\n\nexport const SymAxiosCacheAdapter = Symbol('AxiosCacheAdapter');\n\nexport function CacheRequest(config: Pick<AxiosRequestConfig, 'cache' | 'clearCacheEntry'>)\n{\n\treturn function (target: any, propertyName?: IPropertyKey)\n\t{\n\t\tif (config.cache)\n\t\t{\n\t\t\tlet ret = setupCacheConfig(config);\n\n\t\t\tconst { cache } = ret;\n\n\t\t\tconfig = ret.config;\n\n\t\t\tsetAxiosCacheAdapter(cache, target, propertyName)\n\t\t}\n\n\t\treturn RequestConfigs(config)(target, propertyName);\n\t}\n}\n\nexport function getAxiosCacheAdapter(target: any, propertyName?: IPropertyKey): ISetupCache\n{\n\treturn getMetadataLazy(SymAxiosCacheAdapter, target, propertyName)\n}\n\nexport function setAxiosCacheAdapter(cache: ISetupCache, target: any, propertyName?: IPropertyKey)\n{\n\treturn setMemberMetadata(SymAxiosCacheAdapter, cache, target, propertyName);\n}\n\nexport default CacheRequest;\n"]}