{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;AAKH,iCAAyD;AACzD,0EAAqC;AAKrC,SAAgB,cAAc,CAA+B,KAAsC;IAElG,OAAO,UAAU,MAAW,EAAE,YAA2B;QAExD,IAAI,MAAM,GAAG,IAAA,gBAAS,EAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QAE7C,MAAM,GAAG,IAAA,eAAK,EAAC,MAAM,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;QAEpC,IAAA,gBAAS,EAAC,MAAM,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;QAExC,6CAA6C;IAC9C,CAAC,CAAC;AACH,CAAC;AAZD,wCAYC;AAED,SAAgB,aAAa,CAAqC,GAAM,EAAE,KAA4B,EAAE,SAAmB;IAE1H,OAAO,UAAU,MAAW,EAAE,YAA2B;QAExD,MAAM,MAAM,GAAG,IAAA,gBAAS,EAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QAE/C,IAAI,SAAS,EACb;YACC,MAAM,CAAC,GAAG,CAAC,GAAG,IAAA,eAAK,EAAC,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;SAC9C;aAED;YACC,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;SACpB;QAED,IAAA,gBAAS,EAAC,MAAM,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;IACzC,CAAC,CAAC;AACH,CAAC;AAjBD,sCAiBC;AAED;;;;;;GAMG;AACH,SAAgB,gBAAgB,CAAC,EAAqC;IAErE,OAAO,UAAU,MAAW,EAAE,YAA2B;QAExD,MAAM,MAAM,GAAG,IAAA,gBAAS,EAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QAE/C,aAAa;QACb,IAAI,MAAM,CAAC,gBAAgB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB,CAAC,EACtE;YACC,aAAa;YACb,MAAM,CAAC,gBAAgB,GAAG,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;SACpD;QAED,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EACtB;YACC,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC;SACV;QAED,aAAa;QACb,MAAM,CAAC,gBAAgB,GAAG,MAAM,CAAC,gBAAgB,IAAI,EAAE,CAAC;QAExD,aAAa;QACb,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;QAEpC,uCAAuC;QAEzC,mBAAmB;QACnB,EAAE;QACF,0BAA0B;QAC1B,EAAE;QACF,6BAA6B;QAE3B,IAAA,gBAAS,EAAC,MAAM,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;IACzC,CAAC,CAAA;AACF,CAAC;AAlCD,4CAkCC;AAED;;GAEG;AACH,SAAgB,iBAAiB,CAAC,EAAqC;IAEtE,OAAO,UAAU,MAAW,EAAE,YAA2B;QAExD,MAAM,MAAM,GAAG,IAAA,gBAAS,EAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QAE/C,IAAI,MAAM,CAAC,iBAAiB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,iBAAiB,CAAC,EACxE;YACC,MAAM,CAAC,iBAAiB,GAAG,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;SACtD;QAED,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EACtB;YACC,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC;SACV;QAED,MAAM,CAAC,iBAAiB,GAAG,MAAM,CAAC,iBAAiB,IAAI,EAAE,CAAC;QAE1D,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;QAErC,uCAAuC;QAEzC,mBAAmB;QACnB,EAAE;QACF,0BAA0B;QAC1B,EAAE;QACF,6BAA6B;QAE3B,IAAA,gBAAS,EAAC,MAAM,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;IACzC,CAAC,CAAA;AACF,CAAC;AA9BD,8CA8BC;AAED,kBAAe,aAAa,CAAC","sourcesContent":["/**\n * Created by user on 2019/6/8.\n */\n\nimport { AxiosRequestConfig } from '../../types/axios';\nimport { AxiosTransformer } from 'axios';\nimport { getMetadataLazy, IPropertyKey } from 'reflect-metadata-util';\nimport { getConfig, setConfig, SymConfig } from './util';\nimport merge from '../../util/merge';\nimport { ITSValueOrArray } from 'ts-type';\nimport LazyURLSearchParams from 'http-form-urlencoded';\nimport consoleDebug from '../../util/debug';\n\nexport function RequestConfigs<K extends AxiosRequestConfig>(value: Partial<K | AxiosRequestConfig>)\n{\n\treturn function (target: any, propertyName?: IPropertyKey)\n\t{\n\t\tlet config = getConfig(target, propertyName);\n\n\t\tconfig = merge(config || {}, value);\n\n\t\tsetConfig(config, target, propertyName);\n\n\t\t//consoleDebug.info(`RequestConfigs`, value);\n\t};\n}\n\nexport function RequestConfig<K extends keyof AxiosRequestConfig>(key: K, value: AxiosRequestConfig[K], mergeMode?: boolean)\n{\n\treturn function (target: any, propertyName?: IPropertyKey)\n\t{\n\t\tconst config = getConfig(target, propertyName);\n\n\t\tif (mergeMode)\n\t\t{\n\t\t\tconfig[key] = merge(config[key] || {}, value);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconfig[key] = value;\n\t\t}\n\n\t\tsetConfig(config, target, propertyName);\n\t};\n}\n\n/**\n * 越晚執行的放越上面\n *\n * @param {ITSValueOrArray<AxiosTransformer>} fn\n * @returns {(target: any, propertyName?: IPropertyKey) => void}\n * @constructor\n */\nexport function TransformRequest(fn: ITSValueOrArray<AxiosTransformer>)\n{\n\treturn function (target: any, propertyName?: IPropertyKey)\n\t{\n\t\tconst config = getConfig(target, propertyName);\n\n\t\t// @ts-ignore\n\t\tif (config.transformRequest && !Array.isArray(config.transformRequest))\n\t\t{\n\t\t\t// @ts-ignore\n\t\t\tconfig.transformRequest = [config.transformRequest];\n\t\t}\n\n\t\tif (!Array.isArray(fn))\n\t\t{\n\t\t\tfn = [fn];\n\t\t}\n\n\t\t// @ts-ignore\n\t\tconfig.transformRequest = config.transformRequest || [];\n\n\t\t// @ts-ignore\n\t\tconfig.transformRequest.push(...fn);\n\n\t\t//console.dir(config.transformRequest);\n\n//\t\tmerge(config, {\n//\n//\t\t\ttransformRequest: fn,\n//\n//\t\t} as AxiosRequestConfig);\n\n\t\tsetConfig(config, target, propertyName);\n\t}\n}\n\n/**\n * 越晚執行的放越上面\n */\nexport function TransformResponse(fn: ITSValueOrArray<AxiosTransformer>)\n{\n\treturn function (target: any, propertyName?: IPropertyKey)\n\t{\n\t\tconst config = getConfig(target, propertyName);\n\n\t\tif (config.transformResponse && !Array.isArray(config.transformResponse))\n\t\t{\n\t\t\tconfig.transformResponse = [config.transformResponse];\n\t\t}\n\n\t\tif (!Array.isArray(fn))\n\t\t{\n\t\t\tfn = [fn];\n\t\t}\n\n\t\tconfig.transformResponse = config.transformResponse || [];\n\n\t\tconfig.transformResponse.push(...fn);\n\n\t\t//console.dir(config.transformRequest);\n\n//\t\tmerge(config, {\n//\n//\t\t\ttransformRequest: fn,\n//\n//\t\t} as AxiosRequestConfig);\n\n\t\tsetConfig(config, target, propertyName);\n\t}\n}\n\nexport default RequestConfig;\n"]}