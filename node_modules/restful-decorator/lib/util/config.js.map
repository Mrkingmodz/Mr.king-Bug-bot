{"version":3,"file":"config.js","sourceRoot":"","sources":["config.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;AAGH,mCAA4C;AAC5C,iEAAsE;AAEtE,oDAAiE;AAEjE,6DAAiC;AAGjC,SAAgB,WAAW,CAAoD,QAAgB,EAC9F,aAAgB,EAChB,YAA2B;IAG3B,MAAM,OAAO,GAAG,IAAA,uCAAe,6BAAkC,QAAQ,EAAE,YAAY,CAAC,CAAC;IAEzF,IAAI,YAAY,IAAI,IAAI,EACxB;QACC,IAAA,aAAK,EAAC,aAAa,EAAE,IAAA,uCAAe,EAAC,gBAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;KAC3D;IAED,IAAI,OAAO,IAAI,IAAI,EACnB;QACC,aAAa;QACb,aAAa,CAAC,OAAO,GAAG,IAAA,aAAY,EAAC,OAAO,CAAC,CAAC;KAC9C;IAED,MAAM,MAAM,GAAG,IAAA,gBAAS,EAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;IAEjD,mBAAmB;IAEnB,sBAAsB;IAEtB,IAAA,aAAK,EAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IAE7B,6BAA6B;IAE7B,OAAO,aAAa,CAAC;AACtB,CAAC;AA7BD,kCA6BC;AAED,SAAgB,iBAAiB,CAAoD,QAAW,EAAE,IAAO;IAExG,IAAI,IAAa,CAAC;IAElB,MAAM,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAgB,CAAC;IAE5C,IAAI,EAAE,CAAC,MAAM,EACb;QACC,EAAE;aACA,OAAO,CAAC,UAAU,CAAC;YAEnB,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,WAAW,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,EAC7D;gBACC,IAAI,GAAG,IAAI,CAAC;aACZ;QACF,CAAC,CAAC,CACF;QAED,IAAI,IAAI,EACR;YACC,oBAAoB;YAEpB,QAAQ,GAAG,IAAA,kBAAU,EAAqB,QAAQ,EAAE,IAAI,CAAC,CAAC;YAE1D,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YAE3B,wBAAwB;SACxB;KACD;IAED,OAAO;QACN,IAAI;QACJ,gBAAgB,EAAE,QAAQ;KAC1B,CAAC;AACH,CAAC;AAlCD,8CAkCC;AAED,SAAgB,gBAAgB,CAAoD,aAAgB;IAEnG,IAAI,OAAO,aAAa,CAAC,MAAM,KAAK,QAAQ,EAC5C;QACC,aAAa;QACb,aAAa,CAAC,MAAM,GAAG,aAAa,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;KAC1D;IAED,IAAI,aAAa,CAAC,MAAM,KAAK,KAAK,EAClC;QACC,IAAI,aAAa,CAAC,IAAI,EACtB;YACC,aAAa,CAAC,MAAM,GAAG,IAAA,aAAK,EAA+B,aAAa,CAAC,MAAM,EAAE,aAAa,CAAC,IAAI,CAAC,CAAC;YAErG,OAAO,aAAa,CAAC,IAAI,CAAC;SAC1B;KACD;IAED,OAAO,aAAa,CAAC;AACtB,CAAC;AAnBD,4CAmBC","sourcesContent":["/**\n * Created by user on 2019/6/8.\n */\n\nimport { AxiosRequestConfig } from 'axios';\nimport { merge, mergeClone } from './merge';\nimport { getMetadataLazy, IPropertyKey } from 'reflect-metadata-util';\nimport { EnumRestClientMetadata } from '../decorators/http';\nimport { getConfig, SymConfig } from '../decorators/config/util';\nimport LazyURL from 'lazy-url';\nimport urlNormalize from './url';\nimport { getParamMetadata } from '../decorators/body';\n\nexport function _getSetting<T extends AxiosRequestConfig = AxiosRequestConfig>(thisArgv: object,\n\trequestConfig: T,\n\tpropertyName?: IPropertyKey,\n)\n{\n\tconst baseURL = getMetadataLazy(EnumRestClientMetadata.BASE_URL, thisArgv, propertyName);\n\n\tif (propertyName == null)\n\t{\n\t\tmerge(requestConfig, getMetadataLazy(SymConfig, thisArgv));\n\t}\n\n\tif (baseURL != null)\n\t{\n\t\t// @ts-ignore\n\t\trequestConfig.baseURL = urlNormalize(baseURL);\n\t}\n\n\tconst config = getConfig(thisArgv, propertyName);\n\n\t//console.log(555);\n\n\t//console.dir(config);\n\n\tmerge(requestConfig, config);\n\n\t//console.dir(requestConfig);\n\n\treturn requestConfig;\n}\n\nexport function _chkSettingUpdate<T extends AxiosRequestConfig = AxiosRequestConfig>(defaults: T, opts: T)\n{\n\tlet bool: boolean;\n\n\tconst ks = Object.keys(opts) as (keyof T)[];\n\n\tif (ks.length)\n\t{\n\t\tks\n\t\t\t.forEach(function (k)\n\t\t\t{\n\t\t\t\tif (typeof opts[k] !== 'undefined' && opts[k] !== defaults[k])\n\t\t\t\t{\n\t\t\t\t\tbool = true;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tif (bool)\n\t\t{\n\t\t\t//console.dir(opts);\n\n\t\t\tdefaults = mergeClone<AxiosRequestConfig>(defaults, opts);\n\n\t\t\tfixRequestConfig(defaults);\n\n\t\t\t//console.dir(defaults);\n\t\t}\n\t}\n\n\treturn {\n\t\tbool,\n\t\trequestConfigNew: defaults,\n\t};\n}\n\nexport function fixRequestConfig<T extends AxiosRequestConfig = AxiosRequestConfig>(requestConfig: T)\n{\n\tif (typeof requestConfig.method === 'string')\n\t{\n\t\t// @ts-ignore\n\t\trequestConfig.method = requestConfig.method.toUpperCase();\n\t}\n\n\tif (requestConfig.method === 'GET')\n\t{\n\t\tif (requestConfig.data)\n\t\t{\n\t\t\trequestConfig.params = merge<AxiosRequestConfig[\"params\"]>(requestConfig.params, requestConfig.data);\n\n\t\t\tdelete requestConfig.data;\n\t\t}\n\t}\n\n\treturn requestConfig;\n}\n"]}